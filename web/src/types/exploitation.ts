/**
 * Exploitation Type Definitions
 */

// ============================================================================
// Vulnerability Types
// ============================================================================

export type SeverityLevel = 'critical' | 'high' | 'medium' | 'low' | 'info';

export interface Vulnerability {
  id: string;
  name: string;
  cve?: string;
  severity: SeverityLevel;
  description: string;
  cvss_score?: number;
  discovered_at: number;
  tool: string;
  exploitable: boolean;
  exploit_used?: string;
}

// ============================================================================
// Shell/Session Types
// ============================================================================

export type ShellType = 'reverse' | 'bind' | 'meterpreter' | 'web' | 'ssh';

export interface Shell {
  id: string;
  type: ShellType;
  host: string;
  port: number;
  user?: string;
  privilege_level: 'user' | 'admin' | 'system' | 'root';
  obtained_at: number;
  active: boolean;
  last_ping?: number;
  session_id?: string;
}

// ============================================================================
// Credential Types
// ============================================================================

export type CredentialType = 'password' | 'hash' | 'token' | 'key' | 'cookie';

export interface Credential {
  id: string;
  type: CredentialType;
  username: string;
  secret: string;
  service?: string;
  validated: boolean;
  source: string;
  extracted_at: number;
}

// ============================================================================
// File Types
// ============================================================================

export interface ExploitFile {
  id: string;
  path: string;
  size: number;
  hash?: string;
  type: string;
  downloaded_at: number;
  local_path: string;
  sensitive: boolean;
}

// ============================================================================
// Timeline Types
// ============================================================================

export type TimelineEventType = 'info' | 'success' | 'warning' | 'error';
export type ExploitPhase =
  | 'initialization'
  | 'discovery'
  | 'exploitation'
  | 'post-exploitation'
  | 'completion';

export interface TimelineEvent {
  id: string;
  timestamp: number;
  type: TimelineEventType;
  message: string;
  phase: ExploitPhase;
  details?: unknown;
}

// ============================================================================
// Exploitation Result Types
// ============================================================================

export type ExploitationStatus = 'running' | 'completed' | 'failed';

export interface ExploitationResult {
  id: string;
  exploit_id: string;
  target: string;
  status: ExploitationStatus;
  vulnerabilities: Vulnerability[];
  shells: Shell[];
  credentials: Credential[];
  files: ExploitFile[];
  timeline: TimelineEvent[];
  started_at: number;
  completed_at?: number;
}

// ============================================================================
// WebSocket Event Payloads
// ============================================================================

export interface ExploitStartedEvent {
  exploit_id: string;
  target: string;
  timestamp: number;
}

export interface ExploitCompletedEvent {
  exploit_id: string;
  target: string;
  timestamp: number;
  results: {
    vulnerabilities_found: number;
    shells_obtained: number;
    credentials_extracted: number;
    files_downloaded: number;
  };
}

export interface ExploitFailedEvent {
  exploit_id: string;
  target: string;
  timestamp: number;
  error: string;
}

export interface VulnerabilityDiscoveredEvent {
  exploit_id: string;
  vulnerability: Omit<Vulnerability, 'id'>;
}

export interface ShellObtainedEvent {
  exploit_id: string;
  shell: Omit<Shell, 'id'>;
}

export interface CredentialExtractedEvent {
  exploit_id: string;
  credential: Omit<Credential, 'id'>;
}

export interface FileDownloadedEvent {
  exploit_id: string;
  file: Omit<ExploitFile, 'id'>;
}
