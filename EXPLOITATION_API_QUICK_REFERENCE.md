# Exploitation API - Quick Reference Card

## Endpoints

### 1. Start Exploitation
```
POST /api/v1/exploit/start
```

**Minimal Request**:
```json
{"target": "192.168.1.100"}
```

**Full Request**:
```json
{
  "target": "192.168.1.100",
  "tools": ["nuclei", "ffuf"]
}
```

**Response**:
```json
{
  "exploit_id": "exploit_1735113600",
  "status": "started",
  "target": "192.168.1.100",
  "tools": ["nuclei", "ffuf"]
}
```

---

### 2. Start Bruteforce
```
POST /api/v1/exploit/bruteforce
```

**Minimal Request**:
```json
{"target": "192.168.1.100"}
```

**Full Request**:
```json
{
  "target": "192.168.1.100",
  "service": "ssh",
  "port": 22,
  "wordlist": "rockyou.txt"
}
```

**Response**:
```json
{
  "status": "started",
  "exploit_id": "bruteforce_1735113700",
  "target": "192.168.1.100",
  "service": "ssh",
  "port": 22
}
```

---

## Tool Options

| Tool | Description |
|------|-------------|
| `nuclei` | CVE vulnerability scanning |
| `ffuf` | Directory/file fuzzing |

**Examples**:
- Both tools: `"tools": ["nuclei", "ffuf"]` (default)
- Nuclei only: `"tools": ["nuclei"]`
- FFUF only: `"tools": ["ffuf"]`
- No tools: `"tools": []`

---

## Supported Services

| Service | Default Port | Protocol |
|---------|--------------|----------|
| `ssh` | 22 | SSH |
| `ftp` | 21 | FTP |
| `smtp` | 25 | SMTP |
| `dns` | 53 | DNS |

---

## WebSocket Events

### Event: `phase_change`
```json
{
  "phase": "exploitation",
  "target": "192.168.1.100"
}
```

### Event: `exploit_result`
**Started**:
```json
{
  "exploit_id": "exploit_1735113600",
  "target": "192.168.1.100",
  "event": "started",
  "message": "Starting exploitation on 192.168.1.100",
  "tools": ["nuclei", "ffuf"],
  "timestamp": "2025-12-25T12:00:00.000Z"
}
```

**Completed**:
```json
{
  "exploit_id": "exploit_1735113600",
  "target": "192.168.1.100",
  "event": "completed",
  "message": "Exploitation chain completed",
  "timestamp": "2025-12-25T12:05:00.000Z"
}
```

**Failed**:
```json
{
  "exploit_id": "exploit_1735113600",
  "target": "192.168.1.100",
  "event": "failed",
  "error": "Connection timeout",
  "timestamp": "2025-12-25T12:02:00.000Z"
}
```

---

## cURL Examples

### Start Nuclei Scan
```bash
curl -X POST http://localhost:5000/api/v1/exploit/start \
  -H "Content-Type: application/json" \
  -d '{"target": "testbox.local", "tools": ["nuclei"]}'
```

### Start FFUF Scan
```bash
curl -X POST http://localhost:5000/api/v1/exploit/start \
  -H "Content-Type: application/json" \
  -d '{"target": "testbox.local", "tools": ["ffuf"]}'
```

### Bruteforce SSH
```bash
curl -X POST http://localhost:5000/api/v1/exploit/bruteforce \
  -H "Content-Type: application/json" \
  -d '{"target": "testbox.local", "service": "ssh", "port": 22}'
```

### Bruteforce FTP
```bash
curl -X POST http://localhost:5000/api/v1/exploit/bruteforce \
  -H "Content-Type: application/json" \
  -d '{"target": "testbox.local", "service": "ftp", "port": 21}'
```

---

## JavaScript/TypeScript Examples

### Fetch API - Start Exploitation
```javascript
const response = await fetch('http://localhost:5000/api/v1/exploit/start', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    target: '192.168.1.100',
    tools: ['nuclei', 'ffuf']
  })
});

const data = await response.json();
console.log('Exploit ID:', data.exploit_id);
```

### Fetch API - Start Bruteforce
```javascript
const response = await fetch('http://localhost:5000/api/v1/exploit/bruteforce', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    target: '192.168.1.100',
    service: 'ssh',
    port: 22
  })
});

const data = await response.json();
console.log('Exploit ID:', data.exploit_id);
```

### WebSocket - Listen for Events
```javascript
import io from 'socket.io-client';

const socket = io('http://localhost:5000');

socket.on('phase_change', (data) => {
  console.log('Phase:', data.phase);
});

socket.on('exploit_result', (data) => {
  console.log('Event:', data.event);
  console.log('Message:', data.message);
  if (data.event === 'failed') {
    console.error('Error:', data.error);
  }
});
```

---

## React Hook Example

```typescript
import { useState, useEffect } from 'react';
import io from 'socket.io-client';

export const useExploitation = () => {
  const [phase, setPhase] = useState('idle');
  const [result, setResult] = useState(null);

  useEffect(() => {
    const socket = io('http://localhost:5000');

    socket.on('phase_change', (data) => setPhase(data.phase));
    socket.on('exploit_result', (data) => setResult(data));

    return () => socket.disconnect();
  }, []);

  const startExploit = async (target, tools = ['nuclei', 'ffuf']) => {
    const res = await fetch('http://localhost:5000/api/v1/exploit/start', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ target, tools })
    });
    return res.json();
  };

  const startBruteforce = async (target, service = 'ssh', port = 22) => {
    const res = await fetch('http://localhost:5000/api/v1/exploit/bruteforce', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ target, service, port })
    });
    return res.json();
  };

  return { phase, result, startExploit, startBruteforce };
};
```

---

## Error Handling

### HTTP Status Codes
- `200`: Success
- `400`: Bad request (missing target)
- `500`: Server error

### Error Response Format
```json
{
  "error": "Target required"
}
```

### Example Error Handling
```javascript
try {
  const response = await fetch('/api/v1/exploit/start', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ target: '192.168.1.100' })
  });

  if (!response.ok) {
    const error = await response.json();
    throw new Error(error.error);
  }

  const data = await response.json();
  console.log('Started:', data.exploit_id);
} catch (error) {
  console.error('Exploitation failed:', error.message);
}
```

---

## Default Values Reference

| Parameter | Default Value | Endpoint |
|-----------|---------------|----------|
| `tools` | `["nuclei", "ffuf"]` | /exploit/start |
| `service` | `"ssh"` | /exploit/bruteforce |
| `port` | `22` | /exploit/bruteforce |
| `wordlist` | `"rockyou.txt"` | /exploit/bruteforce |

---

## File Paths Reference

| File | Purpose |
|------|---------|
| `/Users/soulofall/projects/cstrike/api_server.py` | API endpoints |
| `/Users/soulofall/projects/cstrike/modules/exploitation.py` | Exploitation logic |
| `/Users/soulofall/projects/cstrike/EXPLOITATION_API_TESTS.md` | Full test suite |
| `/Users/soulofall/projects/cstrike/EXPLOITATION_BACKEND_INTEGRATION_SUMMARY.md` | Implementation details |

---

## Quick Troubleshooting

| Issue | Solution |
|-------|----------|
| 400 Bad Request | Add "target" field to request body |
| No WebSocket events | Check socket connection and CORS |
| Tools not running | Verify tool names: 'nuclei', 'ffuf' |
| Import errors | Restart API server |

---

## Version
**API Version**: 1.0.0
**Last Updated**: December 25, 2025
